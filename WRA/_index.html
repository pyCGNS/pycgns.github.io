<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CGNS.WRA &#8212; WRA</title>
    
    <link rel="stylesheet" href="_static/pycgns.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/pyCGNS-logo-tiny.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="WRA" href="#" />
    <link rel="next" title="CGNS.WRA.mll" href="API.html" /> 
  </head>
  <body role="document">
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        
        <li class="right" style="margin-right: 10px">
          <a href="search.html" title="search"
             accesskey="S">search</a>
          </li>
        
        <li class="right" >
          <a href="../glossary.html" title="glossary"
             accesskey="G">glossary</a>
           |</li>
        
        <li class="right" >
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
           |</li>
        
        <li class="right" >
          <a href="API.html" title="CGNS.WRA.mll"
             accesskey="N">next</a>
           |</li>
        
        <li class="right" >
          <a href="../index.html" title="pyCGNS top page"
             accesskey="M">top</a>
           |</li>
        
	
	  
	    <li><a href=../index.html>pyCGNS</a> &raquo;</li>
	  
	    
        <li class="nav-item nav-item-0"><a href="#">WRA</a> &#187;</li>
	
        
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

   <h1 align=center><a href="#">
      <img class="logo" src="_static/WRA-logo-small.png" alt="pyCGNS"/>
   </a></h1>


  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">CGNS.WRA</a><ul>
<li><a class="reference internal" href="#mll-examples">MLL Examples</a></li>
<li><a class="reference internal" href="#migration-concerns">Migration concerns</a></li>
<li><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#glossary">Glossary</a><ul>
<li><a class="reference internal" href="#api-index">API Index</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cgns-wra">
<h1>CGNS.WRA<a class="headerlink" href="#cgns-wra" title="Permalink to this headline">¶</a></h1>
<p>The <em>CGNS/MLL</em> and <em>CGNS/ADF</em> wrapper. Provides the user with a <em>Python</em>-like
interface to the <em>CGNS/MLL</em> and <em>CGNS/ADF</em> functions. There are two classes
acting as proxies to the <em>MLL</em> and the <em>ADF</em> calls. The interface to the calls
are most of the time unchanged, that is the order and the types of the
arguments are more or less the same as for the C/Fortran APIs.</p>
<p>The file id is always the first argument in the C/Fortran API, it is
replaced by the class itself which holds the required connection information.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The so-called <em>ADF</em> calls of the <strong>v3</strong> version of <em>CGNS</em> libraries
can read/write <em>ADF</em> as well as <em>HDF5</em> files.</p>
</div>
<div class="section" id="mll-examples">
<h2>MLL Examples<a class="headerlink" href="#mll-examples" title="Permalink to this headline">¶</a></h2>
<p>If you really want to use CGNS/MLL, for example if you have a large toolbox
with old pyCGNS scripts you have to change your
imports from <cite>CGNS.WRA</cite> to <cite>CGNS.WRA.wrapper</cite> for functions. There is a
long example with fake data, the purpose here is to show the syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CGNS.WRA.wrapper</span>
<span class="kn">import</span> <span class="nn">CGNS.PAT.cgnskeywords</span> <span class="k">as</span> <span class="nn">CGK</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">NPY</span>

<span class="n">db</span><span class="o">=</span><span class="n">CGNS</span><span class="o">.</span><span class="n">WRA</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">pyCGNS</span><span class="p">(</span><span class="s1">&#39;testfile.cgns&#39;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">MODE_WRITE</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">basewrite</span><span class="p">(</span><span class="s1">&#39;Base&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">zonewrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Zone 01&#39;</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">CGK</span><span class="o">.</span><span class="n">Structured</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">zonewrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Zone 02&#39;</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">CGK</span><span class="o">.</span><span class="n">Structured</span><span class="p">)</span>

<span class="c1"># beware: the keywords for strings have the _s postfix like below</span>
<span class="c1">#         but enumerates are used without postfix</span>
<span class="c1">#</span>
<span class="n">db</span><span class="o">.</span><span class="n">coordwrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">RealDouble</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">CoordinateX_s</span><span class="p">,</span><span class="n">c01</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">db</span><span class="o">.</span><span class="n">one2onewrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;01-02&quot;</span><span class="p">,</span><span class="s2">&quot;Zone 02&quot;</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">db</span><span class="o">.</span><span class="n">bcwrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;I low&quot;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">BCTunnelInflow</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">PointRange</span><span class="p">,[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="n">db</span><span class="o">.</span><span class="n">bcdatasetwrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;I low DATA SET&quot;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">BCTunnelInflow</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">bcdatawrite</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">Neumann</span><span class="p">)</span>

<span class="c1"># we have now nodes that can be set as children of different node types,</span>
<span class="c1"># then we have to set the parent node using the goto. The current parent</span>
<span class="c1"># is a variable for the current CGNS file.</span>
<span class="c1">#</span>
<span class="n">db</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">1</span><span class="p">,[])</span>
<span class="n">db</span><span class="o">.</span><span class="n">statewrite</span><span class="p">(</span><span class="n">CGK</span><span class="o">.</span><span class="n">ReferenceState_s</span><span class="p">)</span>

<span class="n">db</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="mi">1</span><span class="p">,[(</span><span class="n">CGK</span><span class="o">.</span><span class="n">ReferenceState_t</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="n">db</span><span class="o">.</span><span class="n">arraywrite</span><span class="p">(</span><span class="s2">&quot;Mach&quot;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">1</span><span class="p">,),</span><span class="n">NPY</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">],</span><span class="s1">&#39;d&#39;</span><span class="p">))</span>

<span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>When a function call fails, it sets the error code and error message. You
have to check it at each call if you want to make sure there is no problem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">CGNS.WRA.wrapper</span>
<span class="kn">import</span> <span class="nn">CGNS.PAT.cgnskeywords</span> <span class="k">as</span> <span class="nn">CGK</span>

<span class="n">db</span><span class="o">=</span><span class="n">CGNS</span><span class="o">.</span><span class="n">WRA</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">pyCGNS</span><span class="p">(</span><span class="s1">&#39;testfile.cgns&#39;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">MODE_WRITE</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
  <span class="nb">print</span> <span class="s2">&quot;# Error code:</span><span class="si">%d</span><span class="s2"> message:[</span><span class="si">%s</span><span class="s2">]&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">db</span><span class="o">.</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The actual data is passed to the MLL using the numpy arrays. When you write
you have to create the numpy array, once it is passed to the function you
can delete it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">=</span><span class="n">NPY</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.891</span><span class="p">,</span><span class="mf">4.12</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.2</span><span class="p">],[</span><span class="mf">3.14159</span><span class="p">,</span><span class="mf">3.2</span><span class="p">]],</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">arraywrite</span><span class="p">(</span><span class="s2">&quot;OriginLocation&quot;</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">RealDouble</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<p>When you read, the MLL returns a new numpy array to you, this array now
belongs to you and you can close the CGNS file and/or delete the array, there
is no more relationship between the array and MLL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">fieldread</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">Density_s</span><span class="p">,</span><span class="n">CGK</span><span class="o">.</span><span class="n">RealDouble</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="section" id="migration-concerns">
<h2>Migration concerns<a class="headerlink" href="#migration-concerns" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">The module import keeps the <cite>CGNS.WRA.wrapper</cite> module name.</p>
</li>
<li><p class="first">All constants have to be changed to fit CGNS.PAT.cgnskeywords variables
RealDouble           CGK.RealDouble
RealSingle           CGK.RealSingle</p>
<p>CoordinateX          CGK.CoordinateX_s</p>
<p>...</p>
</li>
</ul>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="API.html">CGNS.WRA.mll</a></li>
<li class="toctree-l1"><a class="reference internal" href="fileformats.html">Handling ADF and HDF5 file formats</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="glossary">
<h1>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h1>
<dl class="glossary docutils">
<dt id="term-cgns-org">cgns.org</dt>
<dd>The official CGNS web site, by extension any document on this web
site has an <em>official</em> taste...</dd>
<dt id="term-cgns">CGNS</dt>
<dd>The specific purpose of the
<a class="reference external" href="http://www.cgns.org">CFD General Notation System (CGNS)</a>
project is to provide a standard for recording and recovering
computer data associated with the numerical solution of the
equations of fluid dynamics. See also the
<a class="reference external" href="/scratch/MOSAIC/W/Marc/pycgns/doc/../build/doc/html/ch2/cgnshowto.html#cgnshowto" title="(in pyCGNS v4)"><span class="xref std std-ref">How to?</span></a>.</dd>
<dt id="term-cgns-sids">CGNS/SIDS</dt>
<dd>The <a class="reference external" href="http://www.grc.nasa.gov/WWW/cgns/CGNS_docs_current/sids/index.html">Standard Interface Data Structure</a> is the
specification of the data model.  This public document describes
the syntax and the semantics of all tree-structured data required
or proposed for a CFD simulation.</dd>
<dt id="term-cgns-mll">CGNS/MLL</dt>
<dd>The <a class="reference external" href="http://www.grc.nasa.gov/WWW/cgns/CGNS_docs_current/lidlevel/index.html">Mid-Level Library</a>
is an example implementation of
<em>CGNS/SIDS</em> on top of <em>CGNS/ADF</em> and <em>CGNS/HDF5</em> mappings. This
library has a C and a Fortran API.</dd>
<dt id="term-cgns-adf">CGNS/ADF</dt>
<dd>The <a class="reference external" href="http://www.grc.nasa.gov/WWW/cgns/CGNS_docs_current/adf/index.html">Advanced Data Format *CGNS/SIDS* implementation</a>. A binary
storage format and its companion library, developped by <em>Boeing</em>.</dd>
<dt id="term-cgns-hdf5">CGNS/HDF5</dt>
<dd>The <a class="reference external" href="http://www.grc.nasa.gov/WWW/cgns/CGNS_docs_current/hdf5/index.html">Hierarchical Data Format *CGNS/SIDS* implementation</a>. A binary
storage format and its companion library (see below).</dd>
<dt id="term-cgns-python">CGNS/Python</dt>
<dd>The <a class="reference external" href="http://www.grc.nasa.gov/WWW/cgns/CGNS_docs_current/python/index.html">Python programming language *CGNS/SIDS*
implementation</a>.</dd>
<dt id="term-chlone">CHLone</dt>
<dd>A <em>CGNS/HDF5</em> compliant implementation. The <a class="reference external" href="http://chlone.sourceforge.net">CHLone</a> library is available on
SourceForge.</dd>
<dt id="term-hdf5">HDF5</dt>
<dd>A powerful storage system for large data.
The <a class="reference external" href="http://www.hdfgroup.org/HDF5">HDF5</a>
library should be seen as a middleware system with a lot of powerful
features related to efficient, portable and trustable storage mean.</dd>
<dt id="term-python">python</dt>
<dd><a class="reference external" href="http://www.python.org">An object oriented interpreted programming language</a>.</dd>
<dt id="term-cython">cython</dt>
<dd>A <a class="reference external" href="http://cython.org">compiler tool</a> that translate Python/Numpy
into C code for performance purpose.</dd>
<dt id="term-numpy">numpy</dt>
<dd>The <a class="reference external" href="http://numpy.scipy.org">numerical library</a> for Python. <em>Numpy</em>
is used to store the data in Python arrays which have a direct memory
mapping to actual C or Fortran memory.</dd>
<dt id="term-vtk">VTK</dt>
<dd>A <a class="reference external" href="http://www.vtk.org">visualization toolkit</a> used to display
3D objects ni <em>CGNS.NAV</em>.</dd>
<dt id="term-pyside">PySide</dt>
<dd>The <a class="reference external" href="http://www.pyside.org">Python interface</a> for the Qt toolkit. PySide</dd>
<dt id="term-qt">Qt</dt>
<dd><a class="reference external" href="http://qt.nokia.com/products">A powerful graphical toolkit</a> available
under GPL v3, LGPL v2 and a commercial license. The current use of Qt is
under LGPL v2 in pyCGNS.</dd>
</dl>
<div class="section" id="api-index">
<span id="wra-index"></span><h2>API Index<a class="headerlink" href="#api-index" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2001-2016, Marc Poinot.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>